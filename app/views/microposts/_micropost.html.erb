<li id="micropost-<%= micropost.id %>">
  <%= link_to gravatar_for(micropost.user, size: 50), micropost.user %>
  <span class="user"><%= link_to micropost.user.name, micropost.user %></span>
  <span class="content"><%= micropost.date %></span>
  <span class="content"><%= micropost.first %></span>
  <span class="content"><%= micropost.second %></span>
  <span class="content"><%= micropost.thrid %></span>
  <span class="timestamp">
    Posted <%= time_ago_in_words(micropost.created_at) %> ago.
  </span>
</li>

<h3 class="col"><div id="test"></div></h3>
<label class="post-label">
  <input type="date" id="setDate" class="col">
</label>

<div class="row">
<table class="table table-bordered">
  <thead style="text-align:center"><tr><th>内容</th><th>結果</th></tr></thead>
  <tr>
    <td><input type="text" value= <%= micropost.first %>></td>
    <td><input type="button" class="btn btn-sm btn-primary" value="達成" onchange=changeValue(this)></td>
  </tr>
  <tr>
    <td><input type="text" value= <%= micropost.second %>></td>
    <td><input type="button" class="btn btn-sm btn-primary" value="達成"></td>
  </tr>
  <tr>
    <td><input type="text" value= <%= micropost.thrid %>></td>
    <td><input type="button" class="btn btn-sm btn-primary" value="達成"></td>
  </tr>
</table>
</div>

<script>
  function setDate(day){
    var now = new Date(day);
    var year = now.getFullYear();
    var month = now.getMonth()+1;
    var date = now.getDate();
    var dateT = ["日","月","火","水","木","金","土"];
    var day = dateT[now.getDay()];
    var content = year + "年" + month + "/" + date + " (" + day + ")";
    document.getElementById("ilmDate").innerHTML = content;
  }
  
  document.getElementById("setDate").onchange = function() { 
    var date = document.getElementById("setDate").value;
    setDate(date);
  };
    
  function setDay(){
    var now = new Date();
    var year = now.getFullYear();
    var month = now.getMonth()+1;
    var date = now.getDate();
    var toTwoDigits = function (num, digit) {
      num += ''
      if (num.length < digit) {
        num = '0' + num
      }
      return num
    }
    var yyyy = toTwoDigits(year, 4)
    var mm = toTwoDigits(month, 2)
    var dd = toTwoDigits(date, 2)
    var today = yyyy + "-" + mm + "-" + dd;
    document.getElementById("setDate").value = today;
    today = yyyy + "/" + mm + "/" + dd;
    setDate(today);
  }
  
  function changeValue($this) {
    if($this.value == "達成") {
      $this.classList.remove("btn-primary");
      $this.classList.add("btn-outline-dark");
      $this.value = "未達成";
    }
    else {
      $this.classList.remove("btn-outline-dark");
      $this.classList.add("btn-primary");
      $this.value = "達成";
    }
  }
    
  setDay();
</script>